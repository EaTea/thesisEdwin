\section{Constructing event models in $\AXKFF$ --- fixed by 7th October 2013}

We have discussed models in the axiom system of $\AXK$.
In particular, we have focused on approximating arbitrary models.
Our approximations can fulfill postconditions and the effects of event model execution, up to modal
depth $n$.
We will replicate a similar result of event model approximation in the axiomatic system
of $\AXKFF$.
This chapter details our results for our event model approximation in the axiomatic system
$\AXKFF$.

\subsection{Background --- fixed by 5 September 2013}

Previously, we constructed models that were tree-like in their nature.
We defined many concepts used to describe trees, such as a ``root", ``subtrees" and ``forests".
This allowed us to approximate arbitrary models in $\AXK$, to model any post-condition we
were interested in.

\begin{figure}[ht!]
\centering
\begin{tikzpicture}[-,>=stealth',shorten >=1pt,auto,node distance=2cm,
			thick]

		\node[vertex] (1) {$\evs_0$};
		\node[vertex] (2) [below left of=1] {$\evs_1$};
		\node[vertex] (3) [right of=2] {$\evs_2$};
		\path[edge]
					(1) edge node {} (2)
					(1) edge node {} (3);
\end{tikzpicture}
\caption{A very simple model that we our previous methodology constructed.
We can immediately see the concept of a ``root" node and ``leaf" nodes.}
\label{exampleModel}
\end{figure}

However, the models we previously generated are not so sensible under an epistemic interpretation.
Indeed, although we can approximate an epistemic event model and the informative update that it
encodes, our resultant model is not so easily interpreted within the original logical systems we
used.
At present, we can thus approximate any event model, whether it is interpretable under epistemic
logics or not.\\
\\
In order to discuss epistemic logic, we need to first impose more restrictions on what axioms our
models must now abide by.
Within a modal logic context, knowledge has a specific structure which results from the axioms
specified in the axiomatic system.
We will move closer to the mainstream axiomatic systems used in epistemic logic by moving to the
axiomatic system $\AXKFF$.
We define the axiomatic system of $\AXKFF$ as follows

\begin{lemma} \label{axiomK45}
The axiomatisation $\AXKFF$ contains the axioms and rules from $\AXK$ (Definition
    \ref{axiomK}), as well as the following axioms
\begin{alignat*}{2}
  & \axFo && \quad \Box \phi \Rightarrow \Box \Box \phi \\
  & \axFi && \quad \Diamond \phi \Rightarrow \Box \Diamond \phi
\end{alignat*}
\end{lemma}

\begin{lemma} \label{axiomK45SoundComplete}
The axiomatisation $\AXKFF$ is sound and complete with respect to the logic
$\lang$.
\end{lemma}

$\AXKFF$ was first constructed by \FIXME and proved to be a sound and complete axiomatic
system by Grossi in \cite{grossi2007designing}.\\
\\
The impact these axioms have on our models is not immediately obvious.
We observe the following effects of the axioms
\begin{itemize}
	\item $\axFo$ causes every relation to be transitive
	\item $\axFi$ has more subtle consequences.
    Suppose $A$ is related to $B$.
    Then if $C$ is related to $A$, $C$ must also be related to $B$.
    A further consequence is that $B$ must also be related to $C$.
\end{itemize}

We demonstrate this in Figure \ref{k45VsKModels} by comparing models in $\AXK$ and $\AXKFF$ and how we need to change
our models to obey these axioms.

\begin{figure}[ht!]
\centering
\begin{subfigure}[b]{.45\textwidth}
\centering
\begin{tikzpicture}[->,>=stealth',shorten >=1pt,auto,node distance=2cm,
      thick]

    \node[vertex] (1) {$\alpha$};
    \node[vertex] (2) [right of=1] {$\beta$};
    \node[vertex] (3) [above right of=2] {$\gamma$};
    \node[vertex] (4) [below right of=2] {$\delta$};
    \path[edge]
          (1) edge node {} (2)
          (2) edge node {} (3)
          (2) edge node {} (4);
\end{tikzpicture}
\caption{Suppose for our Kripke model $\krMo$ (which obeys the rules and axioms in $\AXK$)
  that $\krMo_\alpha \models p$, $\krMo_\beta \models q$, $\krMo_\gamma \models r$ and
  $\krMo_\delta \models q \land p$.
We can say that $\krMo_\alpha \models \Box q$, but we cannot say that $\krMo_\alpha
\models \Box \Box q$.
Then $\axFo$ is disobeyed and thus $\krMo$ is not a $\AXKFF$ event model.}
\label{kmodel}
\end{subfigure}
~
\begin{subfigure}[b]{.45\textwidth}
\centering
\begin{tikzpicture}[->,>=stealth',shorten >=1pt,auto,node distance=2cm,
      thick]

    \node[vertex] (1) {$\alpha$};
    \node[vertex] (2) [right of=1] {$\beta$};
    \node[vertex] (3) [above right of=2] {$\gamma$};
    \node[vertex] (4) [below right of=2] {$\delta$};
    \path[edge]
          (1) edge node {} (2)
              edge node {} (3)
              edge node {} (4)
          (2) edge node {} (3)
              edge node {} (4)
              edge [loop right] node {} (2)
          (3) edge node {} (2)
              edge node {} (4)
              edge [loop above] node {} (3)
          (4) edge node {} (2)
              edge node {} (3)
              edge [loop below] node {} (4);
\end{tikzpicture}
\caption{Now our event model $\krMo'$ obeys $\AXKFF$.
Let $\krMo'_\alpha \models p, \krMo'_\beta \models q, \krMo'_\gamma \models q \land r$ and
  $\krMo'_\delta) \models q \land p$.
Here, we see that (by $\axFo$) in order to say $\krMo'_\alpha \models \Box q$, we must also be
able to say $\krMo'_\alpha \models \Box \Box q$.}
\label{k45model}
\end{subfigure}
\caption{We compare two Kripke models, $\krMo$ (Subfigure \ref{kmodel}) and
  $\krMo'$ (Subfigure \ref{k45model}).}
\label{k45VsKModels}
\end{figure}

In Figure \ref{k45VsKModels} we compare an event model in $\AXK$ to a model in $\AXKFF$.
We have already briefly discussed how $\axFo$ affects the reasonings we can make on the $\krMo_\alpha$ versus
$\krMo'_\alpha$.
Another observation we can make is with regards to the effect of $\axFi$ on $\krMo'_\alpha$ (Subfigure
\ref{k45model}).
By $\axFi$ for any formula $k \in \lang$ such that $\krMo'_\alpha \models
\Diamond k$, we have that $\krMo'_\alpha \models \Box \Diamond k$.
This causes points $\beta, \gamma$ and $\delta$ to become a completely connected component,
with an edge running to each one of them, as well as reflexive edges for each point.\\
\\
%We can approximate informative updates in $\AXKFF$ using our previous method, but as we mentioned
%the generated model is far from resembling an epistemic event model.
%Event models in the axiomatic system $\AXKFF$ resemble epistemic event models much
%more closely.
%Furthermore, any epistemic event model will obey the axioms of $\AXKFF$.\\
We can approximate informative updates using our previous method, but these updates do not preserve
axioms $\axFo$ and $\axFi$.
The resulting model barely resembles an epistemic model.
The approach in this chapter constructs event models that, after their execution on a model that
fulfills the conditions of $\AXKFF$, will preserve those conditions.
\\
An open question, related to our previous chapter --- can we now generate $\AXKFF$ models to
approximate other $\AXKFF$ models?
\FIXME this paragraph is unclear.

\subsection{Technical Preliminaries --- fixed by 11 September 2013}

We first define what a $B$-insane set is.
It is a necessary condition in order to generate our approximating $\AXKFF$ models.

\begin{defn} \label{binsane}
	Let $\evM_\evT = ((\evS, \evR, \evpre), \evT)$ be a multi-pointed event model and $B \subseteq A$.
	We say that $\evM_\evT$ is {\em $B$-insane} if and only if for all $\evs \in \evT$,
  there is no $\evt \in \evS$ and $b \in B$ such that $\evs \evR_b \evt$.
\end{defn}

If $B = \{b\}$, we say that the set $\evM_\evT$ is $b$-insane.
Similarly if $B = A$ we say that $\evM_\evT$ is simply insane, which fulfills
our previous definition of insanity models (Definition \ref{insanity}).\\
\\
What does it mean for a set of states to be $B$-insane?
If $\evM_\evT$ is $B$-insane, then any agent $b$ in $B$ can distinguish between
action points, but only knows the preconditions of each action point.
They do not actually have any knowledge about what they know or any
introspection at each action point.
This is demonstrated in Figure \ref{bInsaneExample}.
\FIXME might need a pagebreak here.

\begin{figure}[ht!]
\centering
\begin{tikzpicture}[->,>=stealth',shorten >=1pt,auto,node distance=2cm,
      thick]

    \node[vertex] (1) {$\alpha$};
    \node[vertex] (2) [below of=1] {$\beta$};
    \node[vertex] (3) [right of=1] {$\gamma$};
    \node[vertex] (4) [below of=3] {$\delta$};
    \path[edge]
          (1) edge node {$B$} (2)
          (3) edge node {$C$} (4)
          (4) edge [loop below] node {$B$} (4);
\end{tikzpicture}
\caption{Consider our event model $\evM$. Let $B$ and $C$ be mutually exclusive
  subsets of $A$. Here, $\evM_\beta$ and $\evM_\gamma$
  are $B$-insane, since there are no outgoing $B$-edges from these event points.
This is easily contrasted with $\evM_\alpha$, which has an outgoing $B$-edge,
     and $\evM_\delta$ which has a reflexive $B$-edge.}
\label{bInsaneExample}
\end{figure}

We now define the main operation to construct event models in $\AXKFF$ for the
purposes of realising a post condition.

\begin{defn} \label{makeEquivalence}
	Let $B \subseteq A$ and $\evM_\evT$ be a multi-pointed event model.
  For each $\evt \in \evT$ let $\evM_\evt$ be a tree event model in $\AXKFF$.
  Then the operation $I_B(\evM_\evT)$ constructs the event model $\evM'_{\evT'} =
  ((\evS',\evR',\evpr'),\evT')$ such that
  \begin{itemize}
    \item $\evS' = \evS$
    \item $\evR'_a = \evR_a$ if $a \notin B$
    \item $\evR'_a = \evR_a \cup \{(\evs, \evt) | \evs, \evt \in \evT\}$ if $a
    \in B$
    \item $\evpr' = \evpr$
    \item $\evT' = \evT$
  \end{itemize}
\end{defn}

We will say that $I_B$ is an operation that makes all the action
points in a ``distinguished" set of a multi-pointed event model ``equivalent" to a
group of agents $B$.
That is, any agent in $B$ considers each action point $\evs \in \evT$ to be the
same.

\begin{figure}[ht!]
\centering
\begin{subfigure}[b]{.45\textwidth}
\centering
\begin{tikzpicture}[->,>=stealth',shorten >=1pt,auto,node distance=2cm,
      thick]

    \node[vertex] (1) {$\alpha$};
    \node[vertex] (2) [below of=1] {$\beta$};
		\node[vertex] (5) [right of=2] {$\tau$};
    \node[vertex] (4) [right of=5] {$\delta$};
    \node[vertex] (3) [above of=4] {$\gamma$};
    \path[edge]
          (1) edge node {$B$} (2)
          (3) edge node {$C$} (4)
          (4) edge [loop below] node {$B$} (4);
\end{tikzpicture}
\caption{Consider the model $\evMo_\evT$, with $\evT = \{\beta, \tau, \gamma\}$.}
\label{beforeOperation}
\end{subfigure}
~
\begin{subfigure}[b]{.45\textwidth}
\centering
\begin{tikzpicture}[->,>=stealth',shorten >=1pt,auto,node distance=2cm,
      thick]

    \node[vertex] (1) {$\alpha$};
    \node[vertex] (2) [below of=1] {$\beta$};
		\node[vertex] (5) [right of=2] {$\tau$};
    \node[vertex] (4) [right of=5] {$\delta$};
    \node[vertex] (3) [above of=4] {$\gamma$};
    \path[edge]
          (1) edge node {$B$} (2)
					(2) edge [loop below] node {$B$} (2)
							edge node {$B$} (5)
							edge node {$B$} (3)
					(5) edge [loop below] node {$B$} (5)
							edge node {} (2)
							edge node {$B$} (3)
          (3) edge node {$C$} (4)
							edge [loop above] node {$B$} (3)
							edge node {} (2)
							edge node {} (5)
          (4) edge [loop below] node {$B$} (4);
\end{tikzpicture}
\caption{Consider our new model $I_B(\evMo_\evT)$, with $\evMo_\evT$ defined as in Subfigure
\ref{beforeOperation}.}
\label{afterOperation}
\end{subfigure}
\caption{Subfigures \ref{beforeOperation} and \ref{afterOperation} demonstrate the effect of
applying our operation $I_B$ onto a model.
Note the }
\label{k45VsKModels}
\end{figure}

The addition of our new operator results in us having the following language for
event model construction in $\AXKFF$.
\[
	\evM_\evT ::= \aMod{M_s} \text{ } | \text{ }\evM_\evT \to_B \evM'_{\evT'} \text{ }|
  \text{ } \evM_\evT \sqcup \evM'_{\evT'} \text{ } | \text{ } I_B(\evM_\evT)
\]
where $\aMod{M_s} \in \insaneClass, \evM_\evT, \evM'_{\evT'}$ are multi-pointed event models and $B \subseteq
A$ is a subset of agents.\\
\\
We will now show that this language always constructs models that preserve $\AXKFF$, and that any
event model that preserves the axioms of $\AXKFF$ can be constructed by our language.

\subsection{Some Interesting Technical Results}

To show that we can construct event models that preserve $\AXKFF$, there are two propositions that
must hold
\begin{enumerate}
	\item we can use our language to construct event models that will preserve $\AXKFF$
	\item an event model that preserves $\AXKFF$ can be constructed (up to $n$-bisimilarity) by our
		language
\end{enumerate}

To show the first proposition, we must first define what event models preserve $\AXKFF$.
We define them formally below.

\begin{lemma} \label{k45EventModel}
	Suppose $\evM_\evT = ((\evS,\evR,\evpre),\evT)$ is a multi-pointed event model with $\evpre$
	defined over $\langArbAct$.
	$\evM_\evT$ preserves the axioms of $\AXKFF$ iff
	\begin{enumerate}
		\item \label{k45EventModelConFour} suppose $a \in A$ and $\evs \in \evS$.
			If $p \in \langArbAct$ and for every $\evt \in \evs \evR_a$, $\evpr(\evt) \Rightarrow p$.
			Then we have that for every $\evt' \in \evt \evR_a$,
			$\evpr(\evt') \Rightarrow p$.
			This corresponds to preserving $\axFo$.
		\item \label{k45EventModelConFive} suppose $a \in A$ and $\evs \in \evS$.
			Suppose $\evt \in \evs \evR_a$ and $p \in \langArbAct$ such that $\evpr(\evt) \Rightarrow p$.
			Then we have that for every $\evs' \in \evs \evR_a$, there is some $\evt' \in \evs' \evR_a$
			such that $\evpre(\evt') \Rightarrow p$.
			This corresponds to preserving $\axFi$.
	\end{enumerate}
	We will refer to these event models as $\AXKFF$ event models.
\end{lemma}
\begin{proof}
	\FIXME: needed?
\end{proof}

We now have a class of models which, upon execution on $\AXKFF$ Kripke models, will preserve the
axioms of $\AXKFF$.
We now present our method for constructing event models using our language.
We will first show that it constructs $\AXKFF$ model.

\begin{lemma}
	Suppose $B \subseteq A$ be a subset of agents.
	Let $\evM'_{\evT'}$ be a $B$-insane $\AXKFF$ event model.
	Let $\aMod{M_p} \in \insaneClass$.
	Then
	\[
		\aMod{M_p} \to_B I_B(\evM'_{\evT'})
	\]
	is an $\AXKFF$ event model.
\end{lemma}
\begin{proof}
	We will prove this in two parts.
	Firstly, we will show that $\evM_\evT = I_B(\evM'_{\evT'})$ is a $\AXKFF$ event model.
	By Lemma \ref{k45EventModel}, there are two conditions we must show.\\
	\\
	We will first show that the first condition (\ref{k45EventModelConFour}) holds at any action point
	in $I_B(\evM'_{\evT'})$.
	Let $\evs \in \evS$, $a \in A$ and suppose $p \in \langArbAct$ such that for all $\evt \in
	\evS$ we have $\evpr(\evt) \Rightarrow p$.
	If $a \notin B$, no new relations are added to $R_a$ and thus the condition must hold.
	Similarly, for $\evs \notin \evT'$, for all $a' \in A$ we have that $\evs R_{a'}$ is not changed and
	thus the condition must hold at these points.\\
	\\
	Thus, we presume that $\evs \in \evT'$ and $a \in B$.
	\begin{align}
		& \vdash \text{for all } \evt \in \evs \evR_a \Rightarrow (\evpr(\evt) \Rightarrow p)
		\label{conFourProof1} \\
		& \vdash \text{for all } \evs' \in \evT' \Rightarrow (\evpr(\evs') \Rightarrow p)
		\label{conFourProof2} \\
		& \vdash \text{for all } \evt' \in \evt \evR_a \Rightarrow (\evpr(\evt') \Rightarrow p)
		\label{conFourProof3}
	\end{align}
	\ref{conFourProof1} follows from hypothesis, \ref{conFourProof2} from the definition of $I_B$
	(Definition \ref{makeEquivalence}) causing $\evs \evR_a = \evT'$, and \ref{conFourProof3} following
	from the definition of $I_B$ causing $\evt \evR_a = \evT'$ and \ref{conFourProof2}.
	This allows us to fulfill Condition \ref{k45EventModelConFour}.\\
	\\
	The second condition we show is (\ref{k45EventModelConFive}) holds at any action point in
	$\evM_\evT$.
	Let $\evs \in \evS$, $a \in A$ and suppose that $p \in \langArbAct$ such that for some $\evt \in \evS$ 
	we have $\evpr(\evt) \Rightarrow p$.
	Again, we note that $a \notin B$ or $\evs \notin \evT'$ automatically fulfills the condition since
	\begin{itemize}
		\item when $a \notin B$, no relations are added to $\evR_a$
		\item when $\evs \notin \evT'$ no relations are added to $\evs \evR_{a'}$ for all $a' \in A$
	\end{itemize}

	Again we presume that $\evs \in \evT'$ and $a \in B$.
	\begin{align}
		& \vdash \text{for some } \evt \in \evs \evR_a \Rightarrow (\evpr(\evt) \Rightarrow p)
		\label{conFiveProof1} \\
		& \vdash \text{for all } \evs' \in \evT' \Rightarrow (\evs' \evR_a = \evT') \label{conFiveProof2}
		\\
		& \vdash \text{for all } \evs' \in \evs \evR_a \Rightarrow (\evt \in \evs' \evR_a)
		\label{conFiveProof3}
	\end{align}
	\ref{conFiveProof1} follows from hypothesis, \ref{conFiveProof2} follows from the definition of
	$I_B$ (Definition \ref{makeEquivalence}) and \ref{conFiveProof3} follows from \ref{conFiveProof2}.
	We thus show Condition \ref{k45EventModelConFive}.\\
	\\
	We have shown that $I_B(\evM'_{\evT'})$ is a $\AXKFF$ event model.
	We now must show that $\evM''_{\evT''} = \aMod{M_p} \to_B I_B(\evM'_{\evT'})$ is a $\AXKFF$ event
	model.
	Since we have shown this for $I_B(\evM'_{\evT'})$, we need only show that conditions
	\ref{k45EventModelConFour} and \ref{k45EventModelConFive} hold at $\evM''_\evp$.
	We can discard having to check other action points since no relations from them are added, and we
	need not check any agents outside of $B$ since they to have no relations added.\\
	\\
	We first check that \ref{k45EventModelConFour} holds.
	Suppose that $a \in B$.
	Suppose $p \in \langArbAct$ and for all $\evt \in \evp \evR''_a = \evT'$ we had
	$\evpr''(\evt) \Rightarrow	p$.
	Since $\evt \evR''_a = \evt \evR_a = \evT'$ then for all $\evt'	\in \evt \evR''_a$ we have that
	$\evpr''(\evt') \Rightarrow p$.
	Thus \ref{k45EventModelConFour} holds.\\
	\\
	Similarly, we can check that \ref{k45EventModelConFive} holds.
	Suppose $a \in B$ and that for $p \in \langArbAct$ there is some $\evt \in \evp \evR''_a = \evT'$
	such that $\evpr''(\evt) \Rightarrow p$.
	We can make a similar argument in \ref{conFiveProof2} and \ref{conFiveProof3} to show that for all
	$\evt' \in \evp \evR''_a$, $\evt \in \evt' \evR''_a$.
	Thus \ref{k45EventModelConFive} holds.\\
	\\
	We have thus shown that both conditions \ref{k45EventModelConFour} and \ref{k45EventModelConFive}
	of Lemma \ref{k45EventModel} hold.
	Then
	\[
		\aMod{M}_\evp \to_B I_B(\evM'_{\evT'})
	\]
	is a \AXKFF event model.
\end{proof}

\newcommand{\EM}{\ensuremath{\eventClass}}

We have shown that any event models generated from $\EM(\to_B,\sqcup, I_B)$ are
$\AXKFF$ event models.
Thus, we can guarantee that if $\evM_\evT$ is a model generated by
$\EM(\to_B,\sqcup,I_B)$ and $\axMo_T$ is a $\AXKFF$ Kripke model, $\axMo_T
\otimes \evM_\evT$ is also a $\AXKFF$ Kripke model.
This shows that the constructions we use --- $\EM(\to_B, \sqcup, I_B)$ are
sound, and will preserve the axioms of $\AXKFF$ after their execution.\\
\\
Let us turn to the second goal we have and suppose that we have an event model, $\evM_\evT
= ((\evS,\evR,\evpr),\evT)$ that is a $\AXKFF$ multi-pointed event model.
Now, consider $n$ some positive integer.
Can we construct an event model $\evM'_{\evT'} = ((\evS',\evR',\evpr'),\evT')$
using $\EM(\to_B,\sqcup,I_B)$ that is $n$-bisimilar to $\evM_\evT$?\\
\\
In order to show this to be possible, we must first conceptualise several
transformations to our models.
Firstly, we will define the idea of a ``generated tree" from a model.

\begin{lemma} \label{generateTree}
  Suppose $\evM_\evT = ((\evS,\evR,\evpr),\evT)$ is a $\AXKFF$ multi-pointed
  event model.
  There is an event model, $\evM'_{\evT'} = ((\evS',\evR',\evpr'),\evT') \sim
  \evM_\evT$, which fulfills the conditions of being a forest event model
  (Definition \ref{forest}), with the exception that
  \begin{itemize}
    \item $\evS'$ is not a finite set
    \item for every $\evs$ in $\evS'$, if $\evR_a \evs$ is non-empty then
    $\evs \evR_a$ is empty
    \item for all $\evs \in \evS'$, if $\evp, \evq \in \evs \evR_a$ then $\evp
    \evR_a \evq$
  \end{itemize}
  We say that $\evM'_{\evT'}$ is the ``generated tree" of $\evM_\evT$.
\end{lemma}
\begin{proof}
  \FIXME finish proof
\end{proof}

The generated tree is an infinite pseudo-forest event model.
This means that the model somewhat resembles our original forest event models,
but with interior relations between the action points, and without the
restriction of finiteness.
We show an example of this in Figure \ref{generatedTreeExample}

\begin{figure}
\centering
\caption{\FIXME Left subfigure should be original, right subfigure should be the
generated tree.} \label{generatedTreeExample}
\end{figure}

The generated tree is bisimilar to the original $\AXKFF$ event model.
However, as it is an infinite event model, it is undesirable to try and
construct this model.
Furthermore, most of the time, we might only be interested in the
post-conditions of a event model that are up to some modal depth.
If we instead consider a finite subtree of the generated tree event
model, we can show that this submodel is $n$-bisimilar to $\evM_\evT$.

\begin{lemma}
  Suppose $\evM_\evT = ((\evS,\evR,\evpr),\evT)$ is a $\AXKFF$ multi-pointed
  event model, and let $\evM'_\evT' = ((\evS', \evR', \evpr'),\evT')$ be the generated tree of $\evM_\evT$.
  Suppose $\evM^n_{\evT^n} = ((\evS^n,\evR^n,\evpr^n),\evT^n)$ is the submodel of $\evM'_\evT'$ such that 
\end{lemma}

\begin{lemma}
	\FIXME this lemma will say that the K45 event models we form will allow us to approximate other
	K45 event models to an arbitrary degree
\end{lemma}
